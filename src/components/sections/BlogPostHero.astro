---
import PageHero from './PageHero.astro';
import SectionLabel from '../ui/SectionLabel.astro';
import { formatDate } from '../../lib/utils';

interface Props {
  post: {
    title: string;
    slug?: { current: string };
    category?: { title: string; slug: { current: string } };
    publishedAt?: string;
    readTime?: string;
    author?: { name: string; slug?: { current: string } };
    heroImageUrl?: string;
  };
}

const { post } = Astro.props;
const formattedDate = post.publishedAt ? formatDate(post.publishedAt) : undefined;
const slug = post.slug?.current;
---

<PageHero
  image={post.heroImageUrl}
  variant="inner"
  imageTransitionName={slug ? `blog-hero-${slug}` : undefined}
>
  <nav class="blog-hero__breadcrumb" aria-label="Breadcrumb">
    <a href="/">Home</a>
    <span class="blog-hero__sep">/</span>
    <a href="/insights/">Insights</a>
    {post.category && (
      <>
        <span class="blog-hero__sep">/</span>
        <a href={`/insights/category/${post.category.slug.current}/`}>{post.category.title}</a>
      </>
    )}
    <span class="blog-hero__sep">/</span>
    <span class="blog-hero__current">{post.title}</span>
  </nav>

  <SectionLabel text="Insights" />

  <h1 style={slug ? `view-transition-name: blog-title-${slug}` : undefined}>
    {post.title}
  </h1>

  <div class="blog-hero__meta">
    {post.category && (
      <span class="blog-hero__category">{post.category.title}</span>
    )}
    {formattedDate && (
      <span class="blog-hero__meta-item">{formattedDate}</span>
    )}
    {post.readTime && (
      <span class="blog-hero__meta-item">{post.readTime} read</span>
    )}
    {post.author && (
      <span class="blog-hero__meta-item">
        By {post.author.name}
      </span>
    )}
  </div>
</PageHero>

<style>
  .blog-hero__breadcrumb {
    font-family: var(--font-body);
    font-size: 11px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--text-secondary);
  }

  .blog-hero__breadcrumb a {
    color: var(--text-secondary);
    text-decoration: none;
    transition: color 0.2s;
  }

  .blog-hero__breadcrumb a:hover {
    color: var(--accent);
  }

  .blog-hero__sep {
    margin: 0 8px;
    color: var(--text-muted);
  }

  .blog-hero__current {
    color: var(--accent);
    display: inline-block;
    max-width: 300px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    vertical-align: bottom;
  }

  .blog-hero__meta {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
    font-family: var(--font-body);
    font-size: 0.875rem;
    font-weight: 300;
    color: var(--text-secondary);
  }

  .blog-hero__category {
    display: inline-block;
    font-size: 11px;
    font-weight: 400;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--accent);
    background: rgba(201, 168, 124, 0.1);
    padding: 6px 12px;
  }

  .blog-hero__meta-item {
    position: relative;
  }

  .blog-hero__meta-item:not(:first-child)::before {
    content: 'â€¢';
    position: absolute;
    left: -0.6rem;
    color: var(--text-muted);
  }

  @media (max-width: 768px) {
    .blog-hero__breadcrumb {
      font-size: 10px;
    }

    .blog-hero__current {
      max-width: 200px;
    }

    .blog-hero__meta {
      font-size: 0.8125rem;
      gap: 0.75rem;
    }
  }

  @media (max-width: 480px) {
    .blog-hero__breadcrumb {
      display: none;
    }
  }
</style>
